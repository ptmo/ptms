<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Putramas Official | Digital Galeri Wayang Nusantara</title>
    <meta name="description" content="Kunjungi Koleksi Wayang Kulit Nusantara Di Galeri Digital Putramas Official">
    <meta name="keywords" content="
Wayang,
Wayang Kulit,
Wayang Kulit Indonesia,
Wayang Indonesia,
Wayang Nusantara,

Wayang Kulit Gagrak Cirebon,
Wayang Gagrak Cirebon,
Wayang Cirebon,
Wayang Kulit Cirebon,

Wayang Kulit Jawa,
Wayang Kulit Jawa Tengah,
Wayang Kulit Jawa Timur,
Wayang Kulit Jawa Barat,

Wayang Kulit Gagrak Yogyakarta,
Wayang Kulit Gagrak Surakarta,
Wayang Kulit Gagrak Solo,
Wayang Kulit Gagrak Banyumas,
Wayang Kulit Gagrak Kedu,
Wayang Kulit Gagrak Mataram,

Wayang Kulit Purwa,
Wayang Kulit Parwa,
Wayang Kulit Bali,
Wayang Bali,

Wayang Kulit Sasak,
Wayang Sasak Lombok,

Wayang Kulit Madura,
Wayang Madura,

Wayang Kulit Banjar,
Wayang Banjar Kalimantan,

Wayang Kulit Betawi,
Wayang Betawi,

Wayang Kulit Sunda,
Wayang Golek,
Wayang Golek Sunda,
        
Wayang Kulit Pesisiran,
Wayang Kulit Pantura,
        
Wayang Ramayana,
Wayang Mahabharata,
Tokoh Wayang,
Arsip Wayang,
Galeri Wayang,
Koleksi Wayang Kulit
">
    <meta name="robots" content="index, follow">

    <link rel="canonical" href="https://putramas.web.id">

    <meta property="og:title" content="Putramas Official | Digital Galeri Wayang Nusantara>
    <meta property="og:description" content="Kunjungi Koleksi Wayang Kulit Nusantara Di Galeri Digital Putramas Official.">
    <meta property="og:url" content="https://putramas.web.id">
    <meta property="og:type" content="website">
    <meta property="og:image" content="https://putramas.web.id/img/og.png">

    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="Putramas Official | Digital Galeri Wayang Nusantara">
    <meta name="twitter:description" content="Kunjungi Koleksi Wayang Kulit Nusantara Di Galeri Digital Putramas Official.">
    <meta name="twitter:image" content="https://putramas.web.id/img/og.png">

    <link rel="icon" href="/img/favicon.ico">
    <link rel="icon" type="image/svg+xml" href="/img/favicon.svg">
    <link rel="apple-touch-icon" href="/img/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="192x192" href="/img/icon-192.png">
    <link rel="icon" type="image/png" sizes="512x512" href="/img/icon-512.png">
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.6.0/css/all.min.css"/>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Rubik:ital,wght@0,600;1,600&display=swap" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/ethers/5.7.2/ethers.umd.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
<style>
  * { box-sizing: border-box; }

        body { 
            font-family: 'Rubik', sans-serif; 
            background-color: #ffffff; 
            color: #f4f1ea; 
            margin: 0;
            padding: 0;
            overflow-x: hidden;
        }

        .navbar {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px 5%;
            background: #f6f9ff;
            backdrop-filter: blur(10px);
            position: sticky;
            top: 0;
            width: 100%;
            z-index: 1000;
            box-shadow: 0 4px 20px rgba(0,0,0,0.5);
        }

        .nav-left { display: flex; align-items: center; gap: 15px; }
        
        .nav-logo {
            width: 45px; height: 45px;
            border-radius: 50%;
            border: 2px solid #7385a5;
            object-fit: cover;
        }

.hero-section {
    position: relative;
    width: 100%;
    min-height: 450px;
    display: flex;
    align-items: center;
    justify-content: center;
    text-align: center;
    background: linear-gradient(rgba(255, 255, 255, 0.9), rgba(255, 255, 255, 0.8)), 
                url('https://putramas.web.id/img/logo2.png');
    background-size: cover;
    background-position: center;
    background-attachment: fixed;
    margin-bottom: 40px;
    box-shadow: 0 10px 30px rgba(0,0,0,0.5);
    overflow: hidden;
    border-radius: 10px;
}
        
.hero-content {
    z-index: 2;
    max-width: 800px;
    padding: 20px;
}

.hero-title {
    font-size: 3.5em;
    font-weight: 800;
    color: #a0aaf8;
    letter-spacing: 5px;
    margin: 0 0 15px 0;
    text-shadow: 2px 2px 4px rgba(0,0,0,0.8);
    opacity: 0;
    animation: fadeInUp 1s ease-out forwards;
}

.hero-subtitle {
    font-size: 0.8em;
    color: #666666;
    font-style: italic;
    margin-bottom: 30px;
    opacity: 0;
    animation: fadeInUp 1s ease-out 0.3s forwards;
}

.btn-upload-hero {
    background: #a6b4cd;
    color: #fff;
    border: 2px solid #7385a5;
    padding: 15px 40px;
    border-radius: 50px;
    font-size: 16px;
    font-weight: bold;
    cursor: pointer;
    letter-spacing: 1px;
    box-shadow: 0 5px 15px rgba(115, 133, 165, 0.4);
    transition: all 0.3s ease;
    opacity: 0;
    animation: fadeInUp 1s ease-out 0.6s forwards;
}

.btn-upload-hero:hover {
    transform: translateY(-5px);
    box-shadow: 0 10px 25px rgba(115, 133, 165, 0.6);
}

@keyframes fadeInUp {
    from {
        opacity: 0;
        transform: translateY(40px);
    }
    to {
        opacity: 1;
        transform: translateY(0);
    }
}

@media (max-width: 600px) {
    .hero-section { min-height: 350px; }
    .hero-title { font-size: 2.2em; letter-spacing: 2px; }
    .btn-upload-hero { padding: 12px 30px; font-size: 14px; }
}
        .galeri-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(260px, 1fr)); gap: 30px; max-width: 1200px; margin: 0 auto; }
        
        .wayang-card { 
            background: #4154f1; border: 1px solid #a6b4cd; border-radius: 8px; overflow: hidden; 
            box-shadow: 0 4px 10px rgba(0,0,0,0.3); transition: transform 0.3s; 
            text-decoration: none; display: flex; flex-direction: column; position: relative;
        }
        .wayang-card:hover { transform: translateY(-8px); border-color: #8094b7; }
        
        .wayang-img { 
            width: 100%; height: 450px; background: #e0e0e0; 
            display: flex; align-items: center; justify-content: center; 
            position: relative; overflow: hidden;
        }
        .wayang-img img { max-width: 97%; max-height: 97%; filter: drop-shadow(5px 5px 5px rgba(0,0,0,0.5)); padding-bottom: 40px; transition: transform 0.3s; }
        .wayang-card:hover .wayang-img img { transform: scale(1.05); }

        .img-overlay-bar {
            position: absolute; bottom: 0; left: 0; width: 100%; height: 35px;
            background: #7385a5; border-top: 2px solid #a6b4cd;
            display: flex; justify-content: space-between; align-items: center;
            padding: 0 15px; z-index: 10; box-sizing: border-box;
        }

        .overlay-date { color: #ccc; font-size: 10px; font-weight: bold; text-transform: uppercase; }
        .overlay-stats { display: flex; gap: 15px; }
        .stat-item {
    display: flex; 
    align-items: center;
    gap: 5px; 
    font-size: 11px; 
    font-weight: bold; 
    color: #deb887;
    line-height: 1;
}

.stat-item img {
    display: block;
    margin: 0;
}

        .card-body { padding: 15px; background: #f6f9ff; }
        .card-meta { display: flex; justify-content: space-between; margin-bottom: 8px; }
        .gaya-text { background: #7385a5; color: white; padding: 2px 8px; border-radius: 4px; font-size: 10px; text-transform: uppercase; }
        .date-text { color: #888; font-size: 11px; font-weight: bold; }
        h3 { margin: 0; font-size: 1.4em; color: #2c241b; font-family: 'Rubik', sans-serif; }
        .stats-row { border-top: 1px solid #eee; margin-top: 10px; padding-top: 8px; font-size: 11px; color: #666; font-style: italic; text-align: center; }
        .owner-badge { position: absolute; top: 10px; left: 10px; background: #3498db; color: white; padding: 3px 8px; border-radius: 4px; font-size: 9px; font-weight: bold; z-index: 5; font-family: 'Rubik', sans-serif; }

        .main-container {
            padding: 20px;
            max-width: 1200px;
            margin: 0 auto;
            min-height: 80vh;
        }

        .footer {
            background: #f6f9ff;
            padding: 20px 20px;
            margin-top: 25px;
            text-align: center;
            width: 100%;
        }

.social-icons { margin-bottom: 10px; }
        
        .social-link {
            display: inline-flex; justify-content: center; align-items: center;
            width: 35px; height: 35px; margin: 0 07px;
            border-radius: 50%; background: #7385a5; color: #fff;
            font-size: 15px; transition: all 0.3s ease; border: 1.5px solid #7385a5;
            text-decoration: none;
        }
        .social-link:hover {
            background: #fff; color: #7385a5;
            transform: translateY(-5px); box-shadow: 0 0 15px #7385a5;
        }

        .copyright { color: #888; font-size: 13px; letter-spacing: 1px; margin-top: 10px; }

        #btn-connect {
            background: transparent; color: #7385a5; border: 2px solid #7385a5; 
            padding: 10px 25px; cursor: pointer; font-family: 'Rubik', sans-serif; 
            font-weight: bold; border-radius: 30px; transition: 0.3s; font-size: 14px;
        }
        #btn-connect:hover { background: #f6f9ff; color: #7385a5; border: 2px solid #7385a5; }
        #btn-connect.connected { background: #abb6c9; color: #fff; border-color: #7385a5; cursor: default; }

        .search-wrapper {
    position: relative;
    width: 100%;
    max-width: 600px;
    margin: 0 auto 30px auto;
}

#searchInput {
    width: 100%;
    padding: 15px 25px;
    border-radius: 50px;
    border: 2px solid #7385a5;
    background: #fff;
    outline: none;
    text-align: center;
    box-shadow: 0 2px 6px rgba(115, 133, 165, 0.25);
    transition:
        box-shadow 0.25s ease,
        border-color 0.25s ease,
        transform 0.25s ease;
}

#searchInput:hover,
#searchInput:focus {
    border-color: #7385a5;
    box-shadow: 0 6px 16px rgba(115, 133, 165, 0.45);
    transform: translateY(-2px);
}
        
        .tab-wrapper { display: flex; justify-content: center; gap: 20px; margin-bottom: 30px; }
        .tab-btn { background: transparent; border: 2px solid #7385a5; color: #7385a5; padding: 12px 30px; border-radius: 30px; font-weight: bold; cursor: pointer; }
        .tab-btn.active { background: #abb6c9; color: #fff; border-color: #7385a5; }
        .galeri-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(260px, 1fr)); gap: 30px; }
        .filter-container { display: flex; flex-wrap: wrap; justify-content: center; gap: 10px; margin-bottom: 30px; }
        .btn-filter { background: #f6f9ff; color: #7385a5; border: 2px solid #7385a5; padding: 8px 15px; border-radius: 20px; cursor: pointer; }
        .btn-filter.active { background: #a6b4cd; color: #fff; }

        @media (max-width: 600px) {
            .navbar { padding: 15px 20px; }
            .nav-brand { font-size: 0.9em; }
            #btn-connect { padding: 8px 15px; font-size: 12px; }
            h1 { font-size: 2em; }
        }

#toast {
    visibility: hidden;
    min-width: 220px;
    max-width: 85%;
    position: fixed;
    z-index: 99999;
    top: 90px;
    right: 20px;
    left: auto;
    background-color: rgba(51, 51, 51, 0.95);
    backdrop-filter: blur(8px);
    box-shadow: 0 10px 30px rgba(0,0,0,0.2);
    border-radius: 10px;
    border: 1px solid rgba(255,255,255,0.15);
    color: #fff;
    padding: 10px 35px 10px 15px; 
    display: flex;
    align-items: center;
    font-family: 'Rubik', sans-serif;
    font-weight: 500;
    font-size: 11px;
    letter-spacing: 0.3px;
    opacity: 0;
    transform: translateX(20px) scale(0.9); 
    transition: all 0.4s cubic-bezier(0.2, 0, 0, 1), visibility 0s 0.4s; 
}

#toast.show {
    visibility: visible;
    opacity: 1;
    transform: translateX(0) scale(1);
    transition: all 0.4s cubic-bezier(0.2, 0, 0, 1), visibility 0s 0s;
}
    
#toast .toast-icon {
    width: 23px;
    height: 23px; 
    margin-right: 10px; 
    object-fit: contain;
}

#toast .toast-close {
    position: absolute;
    top: 10px;
    right: 10px;
    width: 9px;
    height: 9px;
    cursor: pointer;
    opacity: 0.6;
    transition: 0.2s;
}

        #toast .toast-close:hover { opacity: 1; transform: scale(1.1); }

#toast.info {
    background: rgba(0, 53, 107, 0.35);
    border: 1px solid rgba(0, 100, 204, 0.4);
    color: #fff;
    backdrop-filter: blur(18px) saturate(160%);
    -webkit-backdrop-filter: blur(18px) saturate(160%);
    box-shadow: 0 8px 26px rgba(0,0,0,0.35), 0 0 20px rgba(0, 100, 255, 0.25);
}

#toast.success {
    background: rgba(0, 77, 7, 0.35);
    color: #fff;
    border: 1px solid rgba(0, 184, 15, 0.4);
    backdrop-filter: blur(18px) saturate(160%);
    -webkit-backdrop-filter: blur(18px) saturate(160%);
    box-shadow: 0 8px 26px rgba(0,0,0,0.35), 0 0 20px rgba(0,255,0,0.2);
}

#toast.error {
    background: rgba(107, 0, 0, 0.35);
    color: #fff;
    border: 1px solid rgba(184, 0, 0, 0.45);
    backdrop-filter: blur(18px) saturate(160%);
    -webkit-backdrop-filter: blur(18px) saturate(160%);
    box-shadow: 0 8px 26px rgba(0,0,0,0.40), 0 0 22px rgba(255,0,0,0.25);
    }

#toast.warning {
    background: rgba(102, 98, 0, 0.35);
    color: #fff;
    border: 1px solid rgba(179, 171, 0, 0.45);
    backdrop-filter: blur(18px) saturate(160%);
    -webkit-backdrop-filter: blur(18px) saturate(160%);
    box-shadow: 0 8px 26px rgba(0,0,0,0.40), 0 0 20px rgba(255,255,0,0.25);
}

#toast.wolf {
    background: rgba(125, 65, 0, 0.35);
    color: #fff;
    border: 1px solid rgba(204, 106, 0, 0.45);
    backdrop-filter: blur(18px) saturate(160%);
    -webkit-backdrop-filter: blur(18px) saturate(160%);
    box-shadow: 0 8px 26px rgba(0,0,0,0.45), 0 0 20px rgba(255,140,0,0.25);
}

#toast.load {
    background: rgba(49, 77, 0, 0.35);
    color: #fff;
    border: 1px solid rgba(104, 163, 0, 0.45);
    backdrop-filter: blur(18px) saturate(160%);
    -webkit-backdrop-filter: blur(18px) saturate(160%);
    box-shadow: 0 8px 26px rgba(0,0,0,0.45), 0 0 20px rgba(0,255,0,0.25);
}
    
#toast.loading {
    background: rgba(52, 90, 0, 0.35);
    color: #fff;
    border: 1px solid rgba(94, 163, 0, 0.45);
    backdrop-filter: blur(18px) saturate(160%);
    -webkit-backdrop-filter: blur(18px) saturate(160%);
    box-shadow: 0 8px 26px rgba(0,0,0,0.45), 0 0 20px rgba(94, 163, 0, 0.25);
}

@keyframes slideDown {
    from {top: -50px; opacity: 0;}
    to {top: 30px; opacity: 1;}
}

@keyframes fadeOut {
    from {top: 30px; opacity: 1;}
    to {top: -50px; opacity: 0;}
}

/* --- CSS LOADING SPINNER --- */
.img-loader {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    z-index: 5; /* Pastikan di atas background tapi di bawah overlay teks */
    display: flex;
    justify-content: center;
    align-items: center;
}

.spinner-circle {
    width: 30px;
    height: 30px;
    border: 3px solid #e0e0e0;       /* Warna abu-abu muda */
    border-top: 3px solid #d35400;   /* Warna Oranye (Aksen) */
    border-radius: 50%;
    animation: spin 1s linear infinite;
}

@keyframes spin {
    0% { transform: rotate(0deg); }
    100% { transform: rotate(360deg); }
}

    /* --- CSS NOT FOUND BOX --- */
.nf-box {
    max-width: 450px;
    margin: 40px auto; /* Tengah secara horizontal */
    padding: 40px 30px;
    background: #ffffff;
    border-radius: 20px;
    border: 1px solid rgba(115, 133, 165, 0.2); /* Border tipis warna tema */
    box-shadow: 0 15px 40px rgba(115, 133, 165, 0.15); /* Bayangan halus */
    text-align: center;
    transition: transform 0.3s ease;
}

.nf-box:hover {
    transform: translateY(-5px); /* Kotak naik dikit saat dihover */
}

.nf-icon {
    width: 90px;
    height: 90px;
    margin-bottom: 20px;
    transition: all 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275); /* Efek membal */
    filter: grayscale(100%) opacity(0.7); /* Default: Abu-abu pudar */
    cursor: help;
}

/* EFEK HOVER ICON KEREN */
.nf-box:hover .nf-icon {
    filter: grayscale(0%) opacity(1); /* Jadi berwarna */
    transform: scale(1.15) rotate(-10deg); /* Membesar & Miring dikit */
}
</style>
</head>
<body>
     <nav class="navbar">
        <div class="nav-left">
  <a href="index" style="display: flex; align-items: center; text-decoration: none;">
    <img src="img/icon-192.png" class="nav-logo" style="margin-right:8px;">
    <span class="nav-brand" style="font-size:20px; color: #7385a5; font-weight:bold;">Putramas Official</span>
  </a>
        </div>
        <div class="nav-right">
            <button id="btn-connect" onclick="connectWallet()">
    <img src="img/chain.svg" style="width: 18px; height: 18px; vertical-align: middle; margin-right: 8px; margin-bottom: 2px;">
    Hubungkan
            </button>
        </div>
    </nav>

    <div class="main-container">
    
        <section class="hero-section">
    <div class="hero-content">
        <h1 class="hero-title">Wayang Nusantara</h1>
        <p class="hero-subtitle">Arsip Digital Galeri Wayang Nusantara</p>
        
        <button class="btn-upload-hero" onclick="window.location.href='upload_public'">
    <img src="img/up.svg" 
         style="width: 24px; height: 24px; vertical-align: middle; margin-right: 10px; filter: brightness(0) invert(1);">
    Upload Koleksi/Karya Anda
        </button>
    </div>
        </section>

        <div class="search-wrapper">
            <input type="text" id="searchInput" placeholder="Mohon tunggu, sedang memuat database..." onkeyup="smartSearch()">
        </div>

<div class="tab-wrapper" id="tabContainer">
    <button class="tab-btn active" id="tab-official" onclick="switchTab('official')">Koleksi Putramas</button>
    <button class="tab-btn" id="tab-public" onclick="switchTab('public')">Galeri Nusantara</button>
</div>

<div class="filter-container" id="categoryContainer">
    <button class="btn-filter" onclick="filterKategori('Satria', this)">Satria</button>
    <button class="btn-filter" onclick="filterKategori('Dewa', this)">Dewa</button>
    <button class="btn-filter" onclick="filterKategori('Yaksa', this)">Yaksa</button>
    <button class="btn-filter" onclick="filterKategori('Wanara', this)">Wanara</button>
    <button class="btn-filter" onclick="filterKategori('Panakawan', this)">Panakawan</button>
    <button class="btn-filter" onclick="filterKategori('Kayon', this)">Kayon</button>
    <button class="btn-filter" onclick="filterKategori('Bambangan', this)">Bambangan</button>
    <button class="btn-filter" onclick="filterKategori('Punggawa', this)">Punggawa</button>
    <button class="btn-filter" onclick="filterKategori('Krodan', this)">Krodan</button>
    <button class="btn-filter" onclick="filterKategori('Resi', this)">Resi</button>
    <button class="btn-filter" onclick="filterKategori('Putren', this)">Putren</button>
    <button class="btn-filter" onclick="filterKategori('Buta Kiwe', this)">Buta Kiwe</button>
    <button class="btn-filter" onclick="filterKategori('Sato', this)">Sato</button>
    <button class="btn-filter" onclick="filterKategori('Gaman', this)">Gaman</button>
</div>

<div id="containerGaleri" class="galeri-grid">
    <p style="text-align: center; width: 100%; grid-column: 1/-1; color: #aaa;">Menunggu data...</p>
</div>

<div id="toast"></div>

</div> <footer class="footer">
        <div class="footer-content">
            <div class="social-icons">
                <a href="https://youtube.com/@PutramasOfficial" target="_blank" class="social-link"><i class="fab fa-youtube"></i></a>
                <a href="https://instagram.com/putramas_official" target="_blank" class="social-link"><i class="fab fa-instagram"></i></a>
                <a href="https://facebook.com/PutramasOfficial" target="_blank" class="social-link"><i class="fab fa-facebook-f"></i></a>
                <a href="https://facebook.com/PutramasOfficialStudio" target="_blank" class="social-link"><i class="fab fa-facebook-f"></i></a>
            </div>
            <p class="copyright">
                &copy; <span id="year"></span> Powered By <strong>Putramas Official</strong>
            </p>
        </div>
</footer>

<script>
  const CONTRACT_ADDRESS = "0xE6A51b5D204e1bA45e2d607ee53eba3D7E70Bc69"; 
    
    const OFFICIAL_WALLET = "0x736fc1d7b9ad6b2e194717674cd57816d805d294"; 

    const CONTRACT_ABI = [{"inputs":[],"stateMutability":"nonpayable","type":"constructor"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"owner","type":"address"},{"indexed":true,"internalType":"address","name":"approved","type":"address"},{"indexed":true,"internalType":"uint256","name":"tokenId","type":"uint256"}],"name":"Approval","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"owner","type":"address"},{"indexed":true,"internalType":"address","name":"operator","type":"address"},{"indexed":false,"internalType":"bool","name":"approved","type":"bool"}],"name":"ApprovalForAll","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"uint256","name":"id","type":"uint256"},{"indexed":false,"internalType":"address","name":"user","type":"address"}],"name":"Liked","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"uint256","name":"id","type":"uint256"},{"indexed":true,"internalType":"address","name":"uploader","type":"address"},{"indexed":false,"internalType":"string","name":"title","type":"string"}],"name":"NewGalleryUpload","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"uint256","name":"id","type":"uint256"},{"indexed":false,"internalType":"address","name":"user","type":"address"},{"indexed":false,"internalType":"uint8","name":"star","type":"uint8"},{"indexed":false,"internalType":"string","name":"ulasan","type":"string"}],"name":"Reviewed","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"from","type":"address"},{"indexed":true,"internalType":"address","name":"to","type":"address"},{"indexed":true,"internalType":"uint256","name":"tokenId","type":"uint256"}],"name":"Transfer","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"internalType":"uint256","name":"newFee","type":"uint256"}],"name":"UploadFeeUpdated","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"uint256","name":"id","type":"uint256"},{"indexed":false,"internalType":"string","name":"nama","type":"string"},{"indexed":false,"internalType":"string","name":"golongan","type":"string"}],"name":"WayangLahir","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"uint256","name":"id","type":"uint256"},{"indexed":false,"internalType":"string","name":"namaBaru","type":"string"},{"indexed":false,"internalType":"string","name":"uriBaru","type":"string"}],"name":"WayangUpdate","type":"event"},{"inputs":[{"internalType":"string","name":"_title","type":"string"},{"internalType":"string","name":"_imageURI","type":"string"},{"internalType":"string","name":"_description","type":"string"}],"name":"addGalleryItem","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address","name":"to","type":"address"},{"internalType":"uint256","name":"tokenId","type":"uint256"}],"name":"approve","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address","name":"_penerima","type":"address"},{"internalType":"string","name":"_tokenURI","type":"string"},{"internalType":"string","name":"_nama","type":"string"},{"internalType":"string","name":"_golongan","type":"string"},{"internalType":"string","name":"_gaya","type":"string"}],"name":"arsipWayang","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address","name":"owner","type":"address"}],"name":"balanceOf","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"dalang","outputs":[{"internalType":"address","name":"","type":"address"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"emergencyWithdrawETH","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"uint256","name":"","type":"uint256"}],"name":"galleryItems","outputs":[{"internalType":"uint256","name":"id","type":"uint256"},{"internalType":"address","name":"uploader","type":"address"},{"internalType":"string","name":"title","type":"string"},{"internalType":"string","name":"imageURI","type":"string"},{"internalType":"string","name":"description","type":"string"},{"internalType":"uint256","name":"timestamp","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"getAllGalleryItems","outputs":[{"components":[{"internalType":"uint256","name":"id","type":"uint256"},{"internalType":"address","name":"uploader","type":"address"},{"internalType":"string","name":"title","type":"string"},{"internalType":"string","name":"imageURI","type":"string"},{"internalType":"string","name":"description","type":"string"},{"internalType":"uint256","name":"timestamp","type":"uint256"}],"internalType":"struct PutramasWayangArsip.GalleryItem[]","name":"","type":"tuple[]"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint256","name":"tokenId","type":"uint256"}],"name":"getApproved","outputs":[{"internalType":"address","name":"","type":"address"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint256","name":"tokenId","type":"uint256"}],"name":"getAverageRating","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint256","name":"_galleryId","type":"uint256"}],"name":"getGalleryItemById","outputs":[{"components":[{"internalType":"uint256","name":"id","type":"uint256"},{"internalType":"address","name":"uploader","type":"address"},{"internalType":"string","name":"title","type":"string"},{"internalType":"string","name":"imageURI","type":"string"},{"internalType":"string","name":"description","type":"string"},{"internalType":"uint256","name":"timestamp","type":"uint256"}],"internalType":"struct PutramasWayangArsip.GalleryItem","name":"","type":"tuple"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"string","name":"golongan","type":"string"}],"name":"getIdsByGolongan","outputs":[{"internalType":"uint256[]","name":"","type":"uint256[]"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint256","name":"tokenId","type":"uint256"}],"name":"getInfoWayang","outputs":[{"components":[{"internalType":"string","name":"nama","type":"string"},{"internalType":"string","name":"golongan","type":"string"},{"internalType":"string","name":"gaya","type":"string"},{"internalType":"uint256","name":"timestamp","type":"uint256"},{"internalType":"bool","name":"isActive","type":"bool"}],"internalType":"struct PutramasWayangArsip.WayangInfo","name":"","type":"tuple"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint256","name":"tokenId","type":"uint256"}],"name":"getReviews","outputs":[{"components":[{"internalType":"address","name":"reviewer","type":"address"},{"internalType":"uint8","name":"bintang","type":"uint8"},{"internalType":"string","name":"ulasan","type":"string"},{"internalType":"uint256","name":"timestamp","type":"uint256"}],"internalType":"struct PutramasWayangArsip.Review[]","name":"","type":"tuple[]"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint256","name":"","type":"uint256"},{"internalType":"address","name":"","type":"address"}],"name":"hasLiked","outputs":[{"internalType":"bool","name":"","type":"bool"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint256","name":"","type":"uint256"},{"internalType":"address","name":"","type":"address"}],"name":"hasReviewed","outputs":[{"internalType":"bool","name":"","type":"bool"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"owner","type":"address"},{"internalType":"address","name":"operator","type":"address"}],"name":"isApprovedForAll","outputs":[{"internalType":"bool","name":"","type":"bool"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint256","name":"tokenId","type":"uint256"}],"name":"kasihLike","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"uint256","name":"tokenId","type":"uint256"},{"internalType":"uint8","name":"_bintang","type":"uint8"},{"internalType":"string","name":"_ulasanPilihan","type":"string"}],"name":"kasihUlasan","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[],"name":"name","outputs":[{"internalType":"string","name":"","type":"string"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint256","name":"tokenId","type":"uint256"}],"name":"ownerOf","outputs":[{"internalType":"address","name":"","type":"address"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"publicUploadFee","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"string","name":"_title","type":"string"},{"internalType":"string","name":"_imageURI","type":"string"},{"internalType":"string","name":"_description","type":"string"}],"name":"publicUploadGalleryNusantara","outputs":[],"stateMutability":"payable","type":"function"},{"inputs":[{"internalType":"uint256","name":"_tokenId","type":"uint256"},{"internalType":"string","name":"_namaBaru","type":"string"},{"internalType":"string","name":"_uriBaru","type":"string"}],"name":"revisiDataWayang","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address","name":"from","type":"address"},{"internalType":"address","name":"to","type":"address"},{"internalType":"uint256","name":"tokenId","type":"uint256"}],"name":"safeTransferFrom","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address","name":"operator","type":"address"},{"internalType":"bool","name":"approved","type":"bool"}],"name":"setApprovalForAll","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"bytes4","name":"interfaceId","type":"bytes4"}],"name":"supportsInterface","outputs":[{"internalType":"bool","name":"","type":"bool"}],"stateMutability":"pure","type":"function"},{"inputs":[],"name":"symbol","outputs":[{"internalType":"string","name":"","type":"string"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint256","name":"tokenId","type":"uint256"}],"name":"tokenURI","outputs":[{"internalType":"string","name":"","type":"string"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint256","name":"","type":"uint256"}],"name":"totalLikes","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"from","type":"address"},{"internalType":"address","name":"to","type":"address"},{"internalType":"uint256","name":"tokenId","type":"uint256"}],"name":"transferFrom","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address","name":"_owner","type":"address"}],"name":"walletOfOwner","outputs":[{"internalType":"uint256[]","name":"","type":"uint256[]"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint256","name":"","type":"uint256"}],"name":"wayangRegistry","outputs":[{"internalType":"string","name":"nama","type":"string"},{"internalType":"string","name":"golongan","type":"string"},{"internalType":"string","name":"gaya","type":"string"},{"internalType":"uint256","name":"timestamp","type":"uint256"},{"internalType":"bool","name":"isActive","type":"bool"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint256","name":"","type":"uint256"},{"internalType":"uint256","name":"","type":"uint256"}],"name":"wayangReviews","outputs":[{"internalType":"address","name":"reviewer","type":"address"},{"internalType":"uint8","name":"bintang","type":"uint8"},{"internalType":"string","name":"ulasan","type":"string"},{"internalType":"uint256","name":"timestamp","type":"uint256"}],"stateMutability":"view","type":"function"}];

    const BASE_SEPOLIA_RPC = 'https://sepolia.base.org';
    const BASE_ID = '0x14a34'; // 84532

    const BATCH_SIZE = 10;
    let provider, signer;
    let contractReader;
    
    // --- PERBAIKAN SYNTAX ERROR DISINI ---
    let currentTab = 'official'; // Sebelumnya pake titik dua (:), sudah diganti titik koma (;)
    
    let searchIndex = [];
    let publicSearchIndex = [];
    let isSearchReady = false;
    let searchRequestId = 0;
    let globalIds = [];
    let currentOffset = 0;
    let isFetchingBatch = false;
    let toastTimeout;

    window.onload = async function() {
        document.getElementById("year").innerText = new Date().getFullYear();
        
        try {
            const readProvider = new ethers.providers.JsonRpcProvider(BASE_SEPOLIA_RPC);
            contractReader = new ethers.Contract(CONTRACT_ADDRESS, CONTRACT_ABI, readProvider);
            
            const btns = document.querySelectorAll('.btn-filter');
            if(btns.length > 0) btns[0].classList.add('active');
            
            // Load Data
            loadCachedIndex();
            loadGaleri(); 
            buildSearchIndex();
        } catch (e) {
            console.error("Init Error:", e);
        }
    };

    function loadCachedIndex() {
        const cachedData = localStorage.getItem("wayang_search_index");
        if (cachedData) {
            searchIndex = JSON.parse(cachedData);
            isSearchReady = true;
            document.getElementById("searchInput").placeholder = `üîç Cari dari ${searchIndex.length} wayang...`;
        }
    }

    async function buildSearchIndex() {
        // Jangan reset index jika sudah ada, update di background saja
        const golongans = ['Satria', 'Dewa', 'Yaksa', 'Wanara', 'Panakawan', 'Kayon', 'Bambangan', 'Punggawa', 'Krodan', 'Resi', 'Putren', 'Buta Kiwe', 'Sato', 'Gaman'];

        try {
            const promises = golongans.map(async (gol) => {
                const ids = await contractReader.getIdsByGolongan(gol);
                const detailPromises = ids.map(async (id) => {
                    try {
                        const info = await contractReader.getInfoWayang(id);
                        if (!info.isActive) return null;
                        return { 
                            id: id.toString(), 
                            nama: info.nama.toLowerCase(), 
                            gaya: info.gaya.toLowerCase(), 
                            golongan: info.golongan 
                        };
                    } catch(e) { return null; }
                });
                return Promise.all(detailPromises);
            });

            const results = await Promise.all(promises);
            const flatResults = results.flat().filter(i => i !== null);
            const uniqueData = [...new Map(flatResults.map(item => [item.id, item])).values()];
            
            searchIndex = uniqueData;
            isSearchReady = true;
            localStorage.setItem("wayang_search_index", JSON.stringify(searchIndex));
            document.getElementById("searchInput").placeholder = `üîç Cari dari ${searchIndex.length} wayang...`;

        } catch(e) { console.error("Index failed:", e); }
    }

    // --- FUNGSI LOAD GALERI UTAMA ---
    async function loadGaleri() {
        document.getElementById("searchInput").value = "";
        searchRequestId++; 
        const currentRequestId = searchRequestId;
        const container = document.getElementById("containerGaleri");
        
        container.innerHTML = `<p style="text-align:center; color:#80db80; grid-column: 1/-1;">
            <img src="img/loading.svg" style="width: 25px; height: 25px; vertical-align: middle; margin-right: 10px;"> 
            Memuat Data...
        </p>`;

        // === TAB PUBLIK ===
        if (currentTab === 'public') {
            try {
                const rawItems = await contractReader.getAllGalleryItems();
                publicSearchIndex = rawItems; // Simpan untuk search

                // Filter Kategori di Deskripsi
                const filteredItems = rawItems.filter(item => {
                    // Jika kategori "Satria", cari kata "Satria" di deskripsi
                    return item.description.includes(currentCategory);
                });

                const finalItems = filteredItems.reverse();

                if (finalItems.length === 0) {
                    container.innerHTML = `
                    <div style="grid-column: 1/-1; text-align:center; margin-top:40px;">
                        <h3 style="color:#ccc;">Belum ada kiriman ${currentCategory}.</h3>
                    </div>`;
                    return;
                }
                
                await renderPublicGallery(finalItems, container);

            } catch (err) {
                console.error(err);
                // --- REQUEST USER: GANTI PESAN ERROR JADI INSTRUKSI ---
                container.innerHTML = `
                <div style="grid-column: 1/-1; text-align:center; margin-top:50px; color:#7385a5;">
                    <i class="fas fa-search" style="font-size:40px; margin-bottom:15px; opacity:0.3;"></i>
                    <h3>Pilih Kategori Atau Pencarian</h3>
                    <p style="font-size:13px; opacity:0.7;">Silakan pilih tombol kategori di atas.</p>
                </div>`;
            }
            return; 
        }

        // === TAB OFFICIAL ===
        try {
            const ids = await contractReader.getIdsByGolongan(currentCategory);
            
            if (searchRequestId !== currentRequestId) return;
            globalIds = ids.slice().reverse(); 
            currentOffset = 0;
            isFetchingBatch = false;

            if (globalIds.length === 0) {
                container.innerHTML = `<p style="text-align:center; color:#aaa; grid-column: 1/-1;">Belum ada koleksi di kategori ini.</p>`;
                return;
            }
            
            container.innerHTML = ""; 
            await loadNextBatch();

        } catch (err) {
            console.error(err);
            // --- REQUEST USER: GANTI PESAN ERROR JADI INSTRUKSI ---
            container.innerHTML = `
                <div style="grid-column: 1/-1; text-align:center; margin-top:50px; color:#7385a5;">
                    <i class="fas fa-filter" style="font-size:40px; margin-bottom:15px; opacity:0.3;"></i>
                    <h3>Pilih Kategori Atau Pencarian</h3>
                    <p style="font-size:13px; opacity:0.7;">Klik tombol kategori di atas untuk menampilkan wayang.</p>
                </div>`;
        }
    }

    // --- RENDER OFFICIAL (BATCH) ---
    async function loadNextBatch() {
        if (isFetchingBatch || currentOffset >= globalIds.length || document.getElementById("searchInput").value !== "") return;

        isFetchingBatch = true;
        const container = document.getElementById("containerGaleri");
        
        // Loader bawah
        const loaderId = "loader-bottom";
        if (!document.getElementById(loaderId)) {
            container.insertAdjacentHTML('beforeend', `
                <p id="${loaderId}" style="text-align:center; grid-column: 1/-1; color:#888; font-style:italic; margin-top:20px;">
                    <img src="img/loading.svg" style="width: 20px;"> Memuat...
                </p>`);
        }

        const batchIds = globalIds.slice(currentOffset, currentOffset + BATCH_SIZE);
        await renderCards(batchIds, container, false, searchRequestId);
        
        const loaderEl = document.getElementById(loaderId);
        if (loaderEl) loaderEl.remove();

        currentOffset += BATCH_SIZE;
        isFetchingBatch = false;

        // Auto load jika masih kosong layar (misal layar besar)
        if (container.children.length < 5 && currentOffset < globalIds.length) {
            loadNextBatch();
        }
    }

    async function renderCards(ids, container, isSearchMode, requestId) {
        const promises = ids.map(async (id) => {
            try {
                const info = await contractReader.getInfoWayang(id);
                if (!info.isActive) return null;
                
                const likes = await contractReader.totalLikes(id);
                const rating = await contractReader.getAverageRating(id);
                const uri = await contractReader.tokenURI(id);
                
                // Format Gambar
                let imgUrl = "https://via.placeholder.com/300";
                // Kita coba fetch metadata JSON nya untuk dapat gambar
                // (Ini dilakukan async di background agar UI muncul duluan)
                
                return { 
                    id, 
                    nama: info.nama, 
                    gaya: info.gaya, 
                    likes, 
                    rating: (rating/10).toFixed(1), 
                    date: new Date(info.timestamp * 1000).toLocaleDateString(), 
                    metaUri: uri,
                    owner: "Official" 
                };
            } catch (e) { return null; }
        });

        const results = await Promise.all(promises);
        if (searchRequestId !== requestId) return;

        const cleanResults = results.filter(item => item !== null);

        if (cleanResults.length === 0 && isSearchMode) {
            container.innerHTML = `<p style="text-align:center; color:#888; grid-column: 1/-1;">Tidak ada item ditemukan.</p>`;
            return;
        }

        for (const w of cleanResults) {
            // Badge
            const badge = `<div class="owner-badge" style="background:#f1c40f; color:black; border:1px solid #d35400;">üëë Official</div>`;
            
            const html = `
            <a href="detail?id=${w.id}" class="wayang-card">
                <div class="wayang-img">
                    ${badge}
                    <img id="thumb-${w.id}" src="https://via.placeholder.com/300?text=Memuat..." loading="lazy">
                    <div class="img-overlay-bar">
                        <div class="overlay-date">#${w.id}</div>
                        <div class="overlay-stats">
                            <div class="stat-item">‚ù§Ô∏è ${w.likes}</div>
                            <div class="stat-item">‚≠ê ${w.rating}</div>
                        </div>
                    </div>
                </div>
                <div class="card-body">
                    <div class="card-meta"><span class="gaya-text">${w.gaya}</span></div>
                    <h3>${w.nama}</h3>
                </div>
            </a>`;
            container.insertAdjacentHTML('beforeend', html);
            
            // Fetch Gambar Asli (Background Process)
            fetchOfficialImage(w.metaUri, w.id);
        }       
    }

    // --- RENDER PUBLIK ---
    async function renderPublicGallery(items, container) {
        container.innerHTML = ""; 
        for (const item of items) {
            const date = new Date(item.timestamp * 1000).toLocaleDateString();
            
            let httpUri = item.imageURI;
            if (httpUri.startsWith("ipfs://")) httpUri = httpUri.replace("ipfs://", "https://gateway.pinata.cloud/ipfs/");

            // Parsing Gaya
            let gayaLabel = "Komunitas"; 
            const gayaMatch = item.description.match(/Gaya:\s*(.*?)(?:\n|$)/);
            if (gayaMatch) gayaLabel = gayaMatch[1].trim();

            const badge = `<div class="owner-badge" style="background:#3498db; color:white;">Warga</div>`;
            
            const html = `
            <a href="detail?id=G-${item.id}" class="wayang-card">
                <div class="wayang-img">
                    ${badge}
                    <img src="${httpUri}" loading="lazy" onerror="this.src='https://via.placeholder.com/300?text=Error'">
                    <div class="img-overlay-bar">
                        <div class="overlay-date">#G-${item.id}</div>
                    </div>
                </div>
                <div class="card-body">
                    <div class="card-meta"><span class="gaya-text">${gayaLabel}</span></div>
                    <h3>${item.title}</h3>
                </div>
            </a>`;
            container.insertAdjacentHTML('beforeend', html);
        }
    }

    // --- HELPER: FETCH GAMBAR OFFICIAL ---
    async function fetchOfficialImage(metaUri, id) {
        const el = document.getElementById(`thumb-${id}`);
        if(!el) return;
        
        // Cek Cache
        const cacheKey = `thumb_${id}`;
        if(localStorage.getItem(cacheKey)) {
            el.src = localStorage.getItem(cacheKey);
            return;
        }

        try {
            const cleanUri = metaUri.replace("ipfs://", "https://gateway.pinata.cloud/ipfs/");
            const res = await axios.get(cleanUri);
            let rawImg = res.data.image.replace("ipfs://", "https://gateway.pinata.cloud/ipfs/");
            // Optimasi WSRV
            const optImg = `https://wsrv.nl/?url=${encodeURIComponent(rawImg)}&w=300&q=65&output=webp`;
            
            localStorage.setItem(cacheKey, optImg);
            el.src = optImg;
        } catch(e) { console.warn("Gagal thumb", id); }
    }

    // --- SEARCH ---
    async function smartSearch() {
        const query = document.getElementById("searchInput").value.toLowerCase();
        const container = document.getElementById("containerGaleri");
        searchRequestId++; 
        const currentRequestId = searchRequestId;

        if (query.length === 0) {
            document.getElementById("tabContainer").style.display = "flex";
            document.getElementById("categoryContainer").style.display = "flex";
            loadGaleri();
            return;
        }

        document.getElementById("tabContainer").style.display = "none";
        document.getElementById("categoryContainer").style.display = "none";

        // Search logic
        if (currentTab === 'public') {
            container.innerHTML = "";
            const results = publicSearchIndex.filter(item => 
                item.title.toLowerCase().includes(query) || 
                item.description.toLowerCase().includes(query)
            );
            if(results.length === 0) container.innerHTML = "<p style='text-align:center'>Tidak ditemukan.</p>";
            else await renderPublicGallery(results.reverse(), container);
        } else {
            // Official Search
            const results = searchIndex.filter(w => 
                w.nama.includes(query) || w.gaya.includes(query) || w.id === query
            );
            container.innerHTML = "";
            if(results.length === 0) container.innerHTML = "<p style='text-align:center'>Tidak ditemukan.</p>";
            else await renderCards(results.slice(0, 20).map(r => r.id), container, true, currentRequestId);
        }
    }

    // --- UI CONTROLS ---
    function switchTab(tab) {
        currentTab = tab;
        document.getElementById('tab-official').className = tab === 'official' ? 'tab-btn active' : 'tab-btn';
        document.getElementById('tab-public').className = tab === 'public' ? 'tab-btn active' : 'tab-btn';
        
        document.getElementById("categoryContainer").style.display = 'flex'; // Selalu tampilkan kategori
        loadGaleri();
    }

    function filterKategori(kat, btn) {
        if(currentTab === 'public') {
            // Jika di publik klik kategori, tetap di publik tapi filter
            // (Sudah ditangani di loadGaleri)
        } else {
            // Jika official
        }
        currentCategory = kat;
        document.querySelectorAll('.btn-filter').forEach(b => b.classList.remove('active'));
        if(btn) btn.classList.add('active');
        loadGaleri();
    }

    // --- WALLET ---
    async function connectWallet() {
        if (!window.ethereum) return showToast("Install Metamask!", 'wolf');
        try {
            provider = new ethers.providers.Web3Provider(window.ethereum);
            await provider.send("eth_requestAccounts", []);
            
            const net = await provider.getNetwork();
            if(net.chainId !== 84532) {
                await window.ethereum.request({
                    method: 'wallet_switchEthereumChain',
                    params: [{ chainId: BASE_ID }],
                });
            }
            
            signer = provider.getSigner();
            const addr = await signer.getAddress();
            document.getElementById("btn-connect").innerHTML = addr.substring(0,6) + "...";
            document.getElementById("btn-connect").classList.add("connected");
        } catch (e) { showToast("Gagal koneksi: " + e.message, 'error'); }
    }

    function showToast(msg, type) {
        const x = document.getElementById("toast");
        x.innerHTML = `<span>${msg}</span>`;
        x.className = `show ${type}`;
        if(toastTimeout) clearTimeout(toastTimeout);
        toastTimeout = setTimeout(() => x.className = "", 3000);
    }

    // Scroll Load
    window.addEventListener('scroll', () => {
        if ((window.innerHeight + window.scrollY) >= document.body.offsetHeight - 200) {
            if(currentTab === 'official') loadNextBatch();
        }
    });
 
</script>
</body>
</html
