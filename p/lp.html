<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Putramas Official | Wayang Nusantara Shadows Archive</title>
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"/>
    
    <link href="https://unpkg.com/aos@2.3.1/dist/aos.css" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/ethers/5.7.2/ethers.umd.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://unpkg.com/aos@2.3.1/dist/aos.js"></script>
    

    <style>
        /* --- 1. PREMIUM DESIGN SYSTEM --- */
        :root {
            /* Palette */
            --primary: #7385a5;       /* Putramas Blue */
            --primary-dark: #5c6a84;
            --primary-soft: #e3e9f4;
            --gold: #c5a059;          /* Premium Gold Accent */
            --gold-light: #fdf6e3;
            
            /* Backgrounds */
            --bg-body: #f8faff;       /* Ultra Soft Blue-White */
            --surface: #f1f3f6;
            
            /* Typography */
            --text-main: #1e293b;
            --text-muted: #64748b;
            
            /* Glassmorphism */
            --glass: rgba(255, 255, 255, 0.7);
            --glass-border: 1px solid rgba(255, 255, 255, 0.8);
            --blur: blur(20px);
            
            /* Effects */
            --shadow-sm: 0 4px 6px -1px rgba(0, 0, 0, 0.05);
            --shadow-lg: 0 20px 40px -5px rgba(115, 133, 165, 0.15);
            --radius-box: 24px;
            --radius-btn: 100px;
        }

        /* --- 2. RESET & BASE --- */
        * { box-sizing: border-box; margin: 0; padding: 0; outline: none; }
        
        body { 
            font-family: 'Plus Jakarta Sans', sans-serif; 
            background: linear-gradient(135deg, #f6f9ff 0%, #c4d7e8 100%);
            color: var(--text-main); 
            line-height: 1.6;
            overflow-x: hidden;
        }

        a { text-decoration: none; color: inherit; transition: 0.3s; }
        ul { list-style: none; }
        
        /* Smooth Scroll */
        html { scroll-behavior: smooth; }

        /* Container */
        .container {
            width: 100%; max-width: 1200px; margin: 0 auto; padding: 0 20px;
        }
        
        /* Section Utils */
        section { padding: 100px 0; position: relative; overflow: hidden; }
        
        .section-header { text-align: center; max-width: 700px; margin: 0 auto 60px auto; }
        .badge {
            display: inline-block; padding: 8px 16px; border-radius: 50px;
            font-size: 0.75rem; font-weight: 700; letter-spacing: 1px; text-transform: uppercase;
            margin-bottom: 20px;
        }
        .badge-blue { background: var(--primary-soft); color: var(--primary); }
        .badge-gold { background: var(--gold-light); color: var(--gold); }

        h2 { background: linear-gradient(90deg, #7385a5, #a5739e);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent; font-weight: bold; margin-bottom: 15px; letter-spacing: -1px; }
        p.subtitle { color: var(--text-muted); font-weight: bold; font-size: 1.1rem; }

        /* --- 3. NAVBAR (Compact & Fixed) --- */
        #navbar {
            position: fixed; top: 0; left: 0; width: 100%; z-index: 1000;
            padding: 20px 0; transition: all 0.4s ease;
        }
        #navbar.scrolled {
            background: rgba(255, 255, 255, 0.5);
            backdrop-filter: var(--blur);
            -webkit-backdrop-filter: var(--blur);
            border-bottom: 1px solid rgba(255,255,255,0.5);
            padding: 15px 0;
        }
        .nav-inner { display: flex; justify-content: space-between; align-items: center; }
        
        .logo { 
            font-size: 1.25rem; font-weight: 800; color: var(--primary); 
            display: flex; align-items: center; gap: 10px; letter-spacing: -0.5px;
        }
        
        .nav-menu { display: flex; gap: 40px; }
        .nav-menu a { 
            font-weight: 500; color: var(--text-muted); font-size: 0.95rem; 
            position: relative;
        }
        .nav-menu a:hover { color: var(--primary); }

        /* Button System */
        .btn {
            display: inline-flex; align-items: center; justify-content: center; gap: 10px;
            padding: 12px 32px; border-radius: var(--radius-btn);
            font-weight: 600; font-size: 1rem; cursor: pointer;
            transition: all 0.3s cubic-bezier(0.25, 0.8, 0.25, 1);
            white-space: nowrap; border: none;
        }
        .btn-primary {
            background: var(--primary); color: #fff;
            box-shadow: 0 10px 20px rgba(115, 133, 165, 0.3);
        }
        .btn-primary:hover { transform: translateY(-3px); background: var(--primary-dark); }
        
        .btn-gold {
            background: var(--gold); color: #fff;
            box-shadow: 0 10px 20px rgba(197, 160, 89, 0.3);
        }
        .btn-gold:hover { transform: translateY(-3px); background: #b08d4b; }

        .btn-outline {
            background: transparent; border: 1.5px solid var(--primary); color: var(--primary);
        }
        .btn-outline:hover { background: var(--primary); color: #fff; transform: translateY(-3px); }

        /* --- 4. HERO SECTION (Immersive) --- */
        .hero {
            min-height: 100vh; display: flex; align-items: center;
            background: radial-gradient(circle at 10% 10%, rgba(115, 133, 165, 0.05), transparent 50%),
                        radial-gradient(circle at 90% 90%, rgba(197, 160, 89, 0.08), transparent 50%);
            padding-top: 80px; text-align: center;
        }
        .hero h1 {
            font-size: 4rem; line-height: 1.1; margin-bottom: 25px;
            background: linear-gradient(90deg, #7385a5, #a5739e);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        .hero p {
            font-size: 1.25rem; color: var(--text-muted); max-width: 800px; 
            margin: 0 auto 40px auto; font-weight: 400;
        }
        .hero-btns { display: flex; gap: 15px; justify-content: center; flex-wrap: wrap; }

        /* --- 5. TECH STRIP (Credibility) --- */
        .tech-strip {
            background: linear-gradient(135deg, #ffffff 0%, #e3e7ed 90%); border-top: 1px solid rgba(0,0,0,0.03); border-bottom: 1px solid rgba(0,0,0,0.03);
            padding: 30px 0;
        }
        .tech-grid {
            display: flex; justify-content: center; gap: 50px; flex-wrap: wrap;
        }
        .tech-item {
            display: flex; align-items: center; gap: 10px; 
            font-weight: bold; color: #7385a5; font-size: 0.9rem; text-transform: uppercase; letter-spacing: 1px;
            opacity: 0.7; transition: 0.3s;
        }
        .tech-item:hover { opacity: 1; color: #7385a5; }
        .tech-item i { color: #ffa200; }

        /* --- 6. ABOUT (Split Layout) --- */
        
        .about-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 80px; align-items: center; }
        .about-card {
            background: var(--surface); padding: 50px; border-radius: var(--radius-box);
            box-shadow: var(--shadow-lg); border: 1px solid rgba(255,255,255,0.5);
            position: relative; overflow: hidden;
        }

        .about-card::after {
            content: ''; position: absolute; bottom: 0; right: 0; width: 150px; height: 150px;
            background: linear-gradient(135deg, transparent, rgba(197, 160, 89, 0.1));
            border-radius: 50% 0 0 0;
        }

        .about-text {
            background: linear-gradient(135deg, #ffffff 0%, #e3e7ed 90%); padding: 50px; border-radius: var(--radius-box);
            box-shadow: var(--shadow-lg); border: 1px solid rgba(255,255,255,0.5);
            position: relative; overflow: hidden;
        }

        .about-text::after {
            content: ''; position: absolute; bottom: 0; right: 0; width: 150px; height: 150px;
            background: linear-gradient(135deg, transparent, rgba(197, 160, 89, 0.1));
            border-radius: 50% 0 0 0;
        }

        /* --- 7. FEATURES (Bento Grid Style) --- */
        .bento-grid {
            display: grid; grid-template-columns: repeat(4, 1fr); gap: 25px;
            grid-template-rows: auto auto;
        }
        .bento-card {
            background: linear-gradient(135deg, #ffffff 0%, #e3e7ed 90%); padding: 35px; border-radius: var(--radius-box);
            box-shadow: var(--shadow-sm); border: 1px solid rgba(0,0,0,0.02);
            transition: 0.4s; position: relative; overflow: hidden;
        }
        .bento-card:hover { transform: translateY(-5px); box-shadow: var(--shadow-lg); }
        
        .bento-card h3 { margin: 20px 0 10px 0; font-size: 1.25rem; color: var(--text-main); }
        .bento-card ul li {
            margin-bottom: 8px; font-size: 0.9rem; color: var(--text-muted);
            display: flex; align-items: center; gap: 10px;
        }
        .bento-card ul li i { font-size: 6px; color: var(--gold); }

        .icon-box {
            width: 50px; height: 50px; border-radius: 15px;
            display: flex; align-items: center; justify-content: center; font-size: 1.2rem;
            margin-bottom: 15px;
        }
        .ib-gold { background: var(--gold-light); color: var(--gold); }
        .ib-blue { background: var(--primary-soft); color: var(--primary); }

        /* Grid Spans */
        .span-2 { grid-column: span 2; }
        
        /* --- 8. CATEGORIES & SECURITY --- */
        .categories-wrapper { display: flex; flex-wrap: wrap; gap: 15px; justify-content: center; }
        .cat-tag {
            background: var(--surface); border: 1px solid rgba(0,0,0,0.05);
            padding: 10px 25px; border-radius: 50px; font-weight: 600; color: var(--text-muted);
            cursor: default; transition: 0.3s;
        }
        .cat-tag:hover { border-color: var(--primary); color: var(--primary); background: #fff; transform: translateY(-2px); }

        .security-box {
    background: linear-gradient(135deg, #c4d7e8 0%, #f6f9ff 100%);
    border: 2px solid #7385a5;
    padding: 24px; 
    text-align: center;
    color: #73a57a;
    margin-top: 50px;
    width: 100%;
    box-sizing: border-box;
    box-shadow:
    0 8px 20px rgba(0, 0, 0, 0.08),
    0 25px 60px rgba(0, 0, 0, 0.06);
    transition: box-shadow 0.3s ease, transform 0.3s ease;
        }
        
        .security-box h2 { color: #515d73; }
        .security-box p { color: #515d73; }
        .sec-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 30px; margin-top: 40px; }
        .sec-item i { font-size: 2rem; color: #7385a5; margin-bottom: 15px; }
        .sec-item h4 { font-size: 1.1rem; margin-bottom: 5px; }
        .sec-item p { font-size: 0.9rem; color: #515d73; }

        .audience-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 30px; }
        .audience-card { background: linear-gradient(135deg, #ffffff 0%, #e3e7ed 90%); border: 2px solid var(--primary); border-radius: var(--radius-box); box-shadow:
    0 8px 20px rgba(0, 0, 0, 0.08),
    0 25px 60px rgba(0, 0, 0, 0.06);
    transition: box-shadow 0.3s ease, transform 0.3s ease;
                        
   text-align: center; padding: 30px; }

        /* --- 10. FOOTER --- */
        footer { background: linear-gradient(135deg, #ffffff 0%, #e3e7ed 90%);; padding: 80px 0 30px 0; border-top: 1px solid rgba(0,0,0,0.05); }
        .footer-content { text-align: center; }
        .footer-logo { font-size: 1.5rem; font-weight: 800; color: var(--primary); letter-spacing: -1px; }
        .footer-tagline { color: var(--text-muted); margin-top: 10px; font-size: 0.9rem; font-weight: bold; }
        .socials { margin-top: 30px; display: flex; justify-content: center; gap: 20px; }
        .social-btn {
            width: 45px; height: 45px; border-radius: 50%; background: var(--bg-body);
            display: flex; align-items: center; justify-content: center; color: var(--text-muted);
            transition: 0.3s;
        }
        .social-btn:hover { background: var(--primary); color: #fff; transform: translateY(-3px); }
        .copyright { margin-top: 50px; font-size: 0.8rem; color: #515d73; }

        /* --- RESPONSIVE MOBILE --- */
        @media (max-width: 900px) {
            .hero h1 { font-size: 2.8rem; }
            .nav-menu { display: none; }
            .about-grid, .bento-grid, .sec-grid, .audience-grid { grid-template-columns: 1fr; }
            .span-2 { grid-column: span 1; }
            .tech-grid { flex-direction: column; gap: 20px; }
            .container { padding: 0 25px; }
            
            /* Mobile Btn Fix */
            .btn { padding: 8px 20px; font-size: 0.85rem; }
            #btn-connect {
                padding: 6px 16px !important;
                font-size: 0.75rem !important;
                gap: 6px; border-width: 1.5px;
            }
        }

            /* --- TAMBAHAN CSS UNTUK ACTIVITY FEED --- */
    
    /* 1. Kustomisasi Scrollbar (Agar tipis & elegan) */
    #activity-feed::-webkit-scrollbar {
        width: 6px;
    }
    #activity-feed::-webkit-scrollbar-track {
        background: #f1f5f9; 
        border-radius: 4px;
    }
    #activity-feed::-webkit-scrollbar-thumb {
        background: #cbd5e1; 
        border-radius: 4px;
    }
    #activity-feed::-webkit-scrollbar-thumb:hover {
        background: var(--primary); 
    }

    /* 2. Efek Hover pada List Activity */
    #activity-feed li {
        transition: background-color 0.2s ease;
        border-radius: 8px;
        padding: 10px !important; /* Timpa padding inline agar rapi */
        margin-bottom: 5px;
        border-bottom: none !important; /* Hapus garis pemisah kaku */
    }
    #activity-feed li:hover {
        background-color: #f8fafc;
        transform: translateX(5px); /* Efek geser dikit saat di-hover */
        transition: 0.3s;
    }

    </style>

    <style>
        .header { text-align: center; margin-bottom: 50px; }
        .header h1 { font-size: 2.5rem; font-weight: 800; color: var(--primary); margin: 0 0 10px 0; letter-spacing: -1px; }
        .header p { color: var(--text-muted); font-size: 1.1rem; }
        .status-badge { display: inline-block; background: #e0f2f1; color: #00695c; padding: 5px 15px; border-radius: 50px; font-size: 0.8rem; font-weight: 700; margin-top: 15px; }

        /* Grid System */
        .grid-4 { display: grid; grid-template-columns: repeat(auto-fit, minmax(220px, 1fr)); gap: 20px; margin-bottom: 30px; }
        .grid-2 { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 30px; }

        @media(max-width: 800px) { .grid-2 { grid-template-columns: 1fr; } }

        /* Cards */
        .card { background: linear-gradient(135deg, #ffffff 0%, #e3e7ed 90%);; border-radius: var(--radius-box); padding: 30px; box-shadow: var(--shadow); border: 1px solid rgba(0,0,0,0.03); transition: 0.3s; }
        .card:hover { transform: translateY(-5px); box-shadow: 0 20px 40px -10px rgba(115, 133, 165, 0.2); }
        
        /* Stats */
        .stat-label { font-size: 0.8rem; font-weight: 700; color: var(--text-muted); letter-spacing: 1px; margin-bottom: 5px; }
        .stat-value { font-size: 1.8rem; font-weight: 800; color: #00b318; }
        .stat-icon { float: right; font-size: 2rem; opacity: 0.1; color: #ccffd3; margin-top: -30px; }

        /* Charts */
        .chart-box { background: linear-gradient(135deg, #ffffff 0%, #e3e7ed 90%);; border-radius: var(--radius-box); height: 250px; position: relative; width: 100%; }
        .card-title { font-size: 1.1rem; font-weight: 700; margin-bottom: 20px; color: var(--primary-dark); }

        /* Loading Animation */
        .skeleton { background: #e2e8f0; color: transparent !important; border-radius: 6px; animation: pulse 1.5s infinite; }
        @keyframes pulse { 0% { opacity: 0.6; } 50% { opacity: 1; } 100% { opacity: 0.6; } }
   
    /* Progress Bar Tambahan */
        #progress-bar { position: fixed; top: 0; left: 0; width: 0; height: 2px; 

                /* --- TAMBAHAN CSS UNTUK ACTIVITY FEED --- */
    
    /* 1. Kustomisasi Scrollbar (Agar tipis & elegan) */
    #activity-feed::-webkit-scrollbar {
        width: 6px;
    }
    #activity-feed::-webkit-scrollbar-track {
        background: #f1f5f9; 
        border-radius: 4px;
    }
    #activity-feed::-webkit-scrollbar-thumb {
        background: #cbd5e1; 
        border-radius: 4px;
    }
    #activity-feed::-webkit-scrollbar-thumb:hover {
        background: var(--primary); 
    }

    /* 2. Efek Hover pada List Activity */
    #activity-feed li {
        transition: background-color 0.2s ease;
        border-radius: 8px;
        padding: 10px !important; /* Timpa padding inline agar rapi */
        margin-bottom: 5px;
        border-bottom: none !important; /* Hapus garis pemisah kaku */
    }
    #activity-feed li:hover {
        background-color: #f8fafc;
        transform: translateX(5px); /* Efek geser dikit saat di-hover */
        transition: 0.3s;
    }


    </style>
</head>
<body>

    <nav id="navbar">
        <div class="container nav-inner">
            <a href="index" class="logo">
                <i class="fas fa-layer-group"></i>Wayang Nusantara
            </a>
            <div class="nav-menu">
                <a href="#about">Tentang</a>
                <a href="#features">Fitur</a>
                <a href="#category">Arsip</a>
                <a href="#vision">Visi</a>
            </div>
        </div>
    </nav>

    <section class="hero">
        <div class="container" data-aos="fade-up" data-aos-duration="1000">
            <h1>Wayang Nusantara</h1><br><h2>Shadows Archive</h2>
            <p style="font-weight: bold;">Arsip digital wayang berbasis blockchain yang Immutable, terverifikasi, terbuka, dan transparan.</p>
            
            <div class="hero-btns">
                <a href="https://app.putramas.web.id" target="_blank" class="btn btn-primary"><i class="fas fa-fire"></i> Lihat Arsip Wayang</a>
                <a href="https://app.putramas.web.id/upload_public" target="_blank" class="btn btn-outline"><i class="fas fa-cloud-upload-alt"></i> Upload Publik</a>
            </div>
        </div>
    </section>

    <div class="tech-strip">
        <div class="container tech-grid">
            <div class="tech-item"><i class="fas fa-cube"></i> ERC-721 Compatible</div>
            <div class="tech-item"><i class="fas fa-link"></i> On-Chain Metadata</div>
            <div class="tech-item"><i class="fas fa-shield-alt"></i> Immutable Records</div>
            <div class="tech-item"><i class="fas fa-coins"></i> P2P Economy</div>
        </div>
    </div>

    <section id="about" style="padding-top: 15px;">
        <div class="container about-grid">
            <div class="about-card" data-aos="fade-right">
                <i class="fas fa-scroll" style="font-size: 2rem; color: var(--primary); margin-bottom: 25px;"></i>
                <h3 style="font-size: 1.5rem; color: var(--text-main);">Preservasi Digital</h3>
                <p style="font-size: 12px; font-weight: bold; color: #666;">Teknologi Blockchain memastikan setiap data budaya tercatat permanen tanpa risiko manipulasi atau penghapusan sepihak.</p>
            </div>

            <div class="about-card" data-aos="fade-left">
                <i class="fas fa-landmark" style="font-size: 2rem; color: var(--primary); margin-bottom: 25px;"></i>
                <h3 style="font-size: 1.5rem; color: var(--text-main);">Arsip Digital Galeri</h3>
                <p style="font-size: 12px; font-weight: bold; color: #666;">Wayang Nusantara Platform arsip digital galeri, yang tersimpan <strong>Immutable</strong> di teknologi futuristik yang terverifikasi.</p>
            </div>       
        </div>
    </section>

    <section id="features" style="padding-top: 5px;">
        <div class="container">
            <div class="section-header" data-aos="fade-up">
               <h2 style="font-size: 2rem; font-weight: 800; margin-bottom: 30px;">
                Fitur Ekosistem</h2>
                <p class="subtitle">Kombinasi seni tradisional dengan transparansi Web3.</p>
            </div>

            <div class="bento-grid">
                <div class="bento-card span-2" data-aos="fade-up" data-aos-delay="100">
                    <div class="icon-box ib-gold"><i class="fas fa-certificate"></i></div>
                    <h3>Arsip Resmi (Official)</h3>
                    <p style="margin-bottom: 15px; font-size: 12px; font-weight: bold; color: var(--text-muted);">Wayang yang diarsipkan langsung oleh Dalang Putramas dengan metadata lengkap.</p>
                    <ul>
                        <li><i class="fas fa-circle"></i> <strong>Verifikasi On-Chain</strong></li>
                        <li><i class="fas fa-circle"></i> <strong>Metadata Visual & Gaya</strong></li>
                    </ul>
                </div>

                <div class="bento-card span-2" data-aos="fade-up" data-aos-delay="200">
                    <div class="icon-box ib-blue"><i class="fas fa-users"></i></div>
                    <h3>Upload Komunitas</h3>
                    <p style="margin-bottom: 15px; font-size: 12px; font-weight: bold; color: var(--text-muted);">Platform terbuka bagi seniman publik untuk mendokumentasikan karya mereka.</p>
                    <ul>
                        <li><i class="fas fa-circle"></i> <strong>Hak Cipta Kreator</strong></li>
                        <li><i class="fas fa-circle"></i> <strong>Identitas Transparan</strong></li>
                    </ul>
                </div>

                <div class="bento-card" data-aos="fade-up" data-aos-delay="300">
                    <div class="icon-box ib-blue"><i class="fas fa-star"></i></div>
                    <h3>Reputasi Sosial</h3>
                    <ul>
                        <li><i class="fas fa-circle"></i> <strong>Immutable Review</strong></li>
                        <li><i class="fas fa-circle"></i> <strong>Rating 1-5 Bintang</strong></li>
                        <li><i class="fas fa-circle"></i> <strong>Anti-Bot System</strong></li>
                    </ul>
                </div>

                <div class="bento-card span-2" data-aos="fade-up" data-aos-delay="400" style="background: linear-gradient(135deg, #fff 0%, #fffbf0 100%); border: 1px solid rgba(197, 160, 89, 0.2);">
                    <div class="icon-box ib-gold"><i class="fas fa-heart"></i></div>
                    <h3 style="color: var(--gold);">Dukungan Langsung</h3>
                    <p style="margin-bottom: 10px; font-size: 12px; font-weight: bold; color: var(--text-muted);">Kirim tip ETH langsung ke alamat wallet Dalang/Seniman.</p>
                    <ul>
                        <li><i class="fas fa-circle"></i> <strong>Tanpa Potongan Platform</strong></li>
                        <li><i class="fas fa-circle"></i> <strong>Transaksi P2P Instan</strong></li>
                    </ul>
                </div>

                 <div class="bento-card" data-aos="fade-up" data-aos-delay="500">
                    <div class="icon-box ib-blue"><i class="fas fa-lock"></i></div>
                    <h3>Aman & Abadi</h3>
                    <p style="font-size: 12px; font-weight: bold; color: var(--text-muted);">Data tidak bisa dihapus atau disensor sepihak.</p>
                </div>
            </div>
        </div>
    </section>

    <section id="category" style="padding-top: 5px;">
        <div id="progress-bar"></div>

<div class="container">
    
    <div class="header" data-aos="fade-down">
        <h2 style="font-size: 2rem; font-weight: 800; margin-bottom: 30px;">
         Data Publik Wayang Nusantara</h2>
        <div class="status-badge"><i class="fas fa-circle" style="font-size:8px; margin-right:5px;"></i> LIVE DATA</div>
    </div>

    <div class="grid-4" data-aos="fade-up">
        <div class="card">
            <div class="stat-label">Total Wayang</div>
            <div class="stat-value skeleton" id="val-supply">0</div>
            <div class="stat-icon"><i class="fas fa-scroll"></i></div>
        </div>
        <div class="card">
            <div class="stat-label">Biaya Minting</div>
            <div class="stat-value skeleton" id="val-fee">0</div>
            <div class="stat-icon"><i class="fas fa-tag"></i></div>
        </div>
        <div class="card">
            <div class="stat-label">Total Donasi</div>
            <div class="stat-value skeleton" id="val-tips">0</div>
            <div class="stat-icon"><i class="fab fa-ethereum"></i></div>
        </div>
        <div class="card">
            <div class="stat-label">Rasio Official</div>
            <div class="stat-value skeleton" id="val-ratio">0%</div>
            <div class="stat-icon"><i class="fas fa-check-circle"></i></div>
        </div>
    </div>

    <div class="grid-2" data-aos="fade-up" data-aos-delay="100">
        <div class="card">
            <div class="card-title">Distribusi Golongan</div>
            <div class="chart-box"><canvas id="chartGolongan"></canvas></div>
        </div>
        <div class="card">
            <div class="card-title">Distribusi Gaya Seni</div>
            <div class="chart-box"><canvas id="chartGaya"></canvas></div>
        </div>
    </div>
</div>
</section>

<section id="vision" style="padding-top: 5px;">
        <div class="grid-2" data-aos="fade-up" data-aos-delay="200">
    
    <div class="card" style="height: 450px; overflow: hidden; display: flex; flex-direction: column;">
        <div class="card-title" style="display: flex; align-items: center;">
            <span style="
                width: 10px; height: 10px;
                background-color: #27ae60;
                border-radius: 50%;
                display: inline-block;
                margin-right: 12px;
                box-shadow: 0 0 8px rgba(39, 174, 96, 0.8);
                animation: pulse 2s infinite;
            "></span>
            Live Aktivitas Global
        </div>

        <div style="flex: 1; overflow-y: auto; padding-right: 5px;" id="activity-feed">
            <div style="text-align:center; padding: 20px; color: #ccc;">
                <i class="fas fa-circle-notch fa-spin"></i> Memuat data live...
            </div>
        </div>
    </div>

    <div class="card" style="height: 450px; display: flex; flex-direction: column;">
        <div class="card-title">
            <i class="fas fa-crown" style="color: var(--gold); margin-right: 8px;"></i>
            Panggung Populer (Top Likes)
        </div>
        
        <div style="background: #fff8e1; padding: 10px 15px; border-radius: 12px; margin-bottom: 15px; display: flex; justify-content: space-between; align-items: center; border: 1px solid #ffe0b2;">
            <span style="font-size: 0.85rem; color: #f57c00; font-weight: 600;">Total Love Komunitas</span>
            <span id="val-total-likes" style="font-size: 1rem; font-weight: 800; color: #e65100;">0</span>
        </div>

        <div id="top-wayang-list" style="flex: 1; overflow-y: auto; padding-right: 5px;">
            <div style="text-align:center; padding: 40px 0; color: #ccc;">
                <i class="fas fa-circle-notch fa-spin"></i> Memuat chart...
            </div>
        </div>
    </div>

</div>

</section>

    <section style="padding-top: 5px;">
            <div class="security-box" data-aos="zoom-in">
                <h2>Data Tidak Bisa Dipalsukan</h2>
                <p style="font-weight: bold; font-size: 12px;">Wayang Nusantara adalah platform arsip digital galeri terdesentralisasi pertama di Indonesia.</p>
                
                <div class="sec-grid">
                    <div class="sec-item">
                        <i class="fas fa-fingerprint"></i>
                        <h4>Autentik</h4>
                        <p style="font-weight: bold; font-size: 12px;">Tanda tangan digital kreator.</p>
                    </div>
                    <div class="sec-item">
                        <i class="fas fa-database"></i>
                        <h4>Terdesentralisasi</h4>
                        <p style="font-weight: bold; font-size: 12px;">Tidak ada server pusat tunggal.</p>
                    </div>
                    <div class="sec-item">
                        <i class="fas fa-clock"></i>
                        <h4>Timestamp</h4>
                        <p style="font-weight: bold; font-size: 12px;">Bukti waktu upload akurat.</p>
                    </div>
                </div>
            </div>
    </section>

    <section id="vision" style="padding-top: 5px;">
        <div class="container">
        <div style="max-width: 600px; margin: 0 auto 60px auto; text-align: center;" data-aos="fade-up">
                <h2 style="font-size: 2rem; font-weight: 800; margin-bottom: 30px;">
                    Bergabung Bersama Kami
                </h2>
                
                <div style="display: flex; gap: 20px;">
                    <a href="#" class="btn btn-connect" style="flex: 1; justify-content: center; margin-top: 0; background: none; color: var(--primary); border: 2px solid var(--primary); font-weight: bold;">
                        <i class="fas fa-box-archive"></i> Lihat Arsip
                    </a>
                    <a href="#" class="btn btn-connect" style="flex: 1; justify-content: center; margin-top: 0; background: none; color: var(--primary); border: 2px solid var(--primary); font-weight: bold;">
                        <i class="fas fa-cloud-upload-alt"></i> Upload Publik
                    </a>
                </div>
        </div>
            <div class="audience-grid" style="margin-top: 80px;">
                <div class="audience-card" data-aos="fade-up" data-aos-delay="100">
                    <div style="font-size: 3rem; margin-bottom: 20px; color: #7385a5;">
    <i class="fas fa-masks-theater"></i>
                    </div>
                    <h4>Dalang & Seniman</h4>
                    <p style="font-size: 0.9rem; color: var(--text-muted); font-weight: bold; font-size: 12px;">Dokumentasi karya & reputasi publik.</p>
                </div>
                <div class="audience-card" data-aos="fade-up" data-aos-delay="200">
                    <div style="font-size: 3rem; margin-bottom: 20px; color: #7385a5;">
    <i class="fas fa-landmark"></i>
                    </div>
                    <h4>Peneliti Budaya</h4>
                    <p style="font-size: 0.9rem; color: var(--text-muted); font-weight: bold; font-size: 12px;">Data autentik terverifikasi untuk riset.</p>
                </div>
                <div class="audience-card" data-aos="fade-up" data-aos-delay="300">
                    <div style="font-size: 3rem; margin-bottom: 20px; color: #7385a5;">
    <i class="fas fa-globe-asia"></i>
                    </div>
                    <h4>Web3 Community</h4>
                    <p style="font-size: 0.9rem; color: var(--text-muted); font-weight: bold; font-size: 12px;">Koleksi aset budaya nyata & bernilai.</p>
                </div>
                </div>
        </div>
    </section>

    <footer>
        <div class="container footer-content">
            <div class="footer-logo">Wayang Nusantara</div>
            <p class="footer-tagline"> On-Chain Forever</p>
            
            <div class="socials">
                <a href="#" class="social-btn"><i class="fab fa-twitter"></i></a>
                <a href="#" class="social-btn"><i class="fab fa-discord"></i></a>
                <a href="#" class="social-btn"><i class="fab fa-instagram"></i></a>
                <a href="#" class="social-btn"><i class="fas fa-envelope"></i></a>
            </div>

            <p class="copyright">&copy; <span id="year"></span> <strong>Powered By Putramas Official.</strong> All Rights Reserved.</p>
        </div>
    </footer>

    <script>
    AOS.init({ duration: 800, once: true });

    // --- CONFIG ---
    const CONTRACT_ADDRESS = "0x72359F776Ac4B44c6c79dBF805D79959515E0c58";
    const ALCHEMY_KEY = '9WNWGMuDgG3vg8xYOM7xs'; // Key dari screenshot Anda
    const ALCHEMY_RPC = `https://base-mainnet.g.alchemy.com/v2/${ALCHEMY_KEY}`;
    const PUBLIC_RPC = "https://mainnet.base.org"; // Fallback

    const ABI = [{"inputs":[],"stateMutability":"nonpayable","type":"constructor"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"owner","type":"address"},{"indexed":true,"internalType":"address","name":"approved","type":"address"},{"indexed":true,"internalType":"uint256","name":"tokenId","type":"uint256"}],"name":"Approval","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"owner","type":"address"},{"indexed":true,"internalType":"address","name":"operator","type":"address"},{"indexed":false,"internalType":"bool","name":"approved","type":"bool"}],"name":"ApprovalForAll","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"internalType":"uint256","name":"newFee","type":"uint256"}],"name":"FeeUpdated","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"uint256","name":"id","type":"uint256"},{"indexed":false,"internalType":"address","name":"user","type":"address"}],"name":"Liked","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"uint256","name":"id","type":"uint256"},{"indexed":false,"internalType":"address","name":"user","type":"address"},{"indexed":false,"internalType":"uint8","name":"star","type":"uint8"},{"indexed":false,"internalType":"string","name":"ulasan","type":"string"}],"name":"Reviewed","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"internalType":"uint256","name":"newFee","type":"uint256"}],"name":"RevisionFeeUpdated","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"from","type":"address"},{"indexed":true,"internalType":"address","name":"to","type":"address"},{"indexed":false,"internalType":"uint256","name":"amount","type":"uint256"},{"indexed":false,"internalType":"string","name":"message","type":"string"},{"indexed":false,"internalType":"uint256","name":"timestamp","type":"uint256"}],"name":"TipSent","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"uint256","name":"id","type":"uint256"},{"indexed":false,"internalType":"string","name":"nama","type":"string"},{"indexed":false,"internalType":"string","name":"golongan","type":"string"},{"indexed":false,"internalType":"bool","name":"isOfficial","type":"bool"},{"indexed":false,"internalType":"address","name":"creator","type":"address"}],"name":"WayangLahir","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"uint256","name":"id","type":"uint256"},{"indexed":false,"internalType":"string","name":"namaBaru","type":"string"},{"indexed":false,"internalType":"string","name":"uriBaru","type":"string"}],"name":"WayangUpdate","type":"event"},{"inputs":[],"name":"MAX_TIP","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"MIN_TIP","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"to","type":"address"},{"internalType":"uint256","name":"tokenId","type":"uint256"}],"name":"approve","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address","name":"_penerima","type":"address"},{"internalType":"string","name":"_tokenURI","type":"string"},{"internalType":"string","name":"_nama","type":"string"},{"internalType":"string","name":"_golongan","type":"string"},{"internalType":"string","name":"_gaya","type":"string"}],"name":"arsipWayang","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address","name":"owner","type":"address"}],"name":"balanceOf","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"dalang","outputs":[{"internalType":"address","name":"","type":"address"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"emergencyWithdrawETH","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"uint256","name":"tokenId","type":"uint256"}],"name":"getApproved","outputs":[{"internalType":"address","name":"","type":"address"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint256","name":"tokenId","type":"uint256"}],"name":"getAverageRating","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"string","name":"golongan","type":"string"}],"name":"getIdsByGolongan","outputs":[{"internalType":"uint256[]","name":"","type":"uint256[]"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint256","name":"tokenId","type":"uint256"}],"name":"getInfoWayang","outputs":[{"components":[{"internalType":"string","name":"nama","type":"string"},{"internalType":"string","name":"golongan","type":"string"},{"internalType":"string","name":"gaya","type":"string"},{"internalType":"uint256","name":"timestamp","type":"uint256"},{"internalType":"bool","name":"isActive","type":"bool"},{"internalType":"bool","name":"isOfficial","type":"bool"},{"internalType":"address","name":"creator","type":"address"}],"internalType":"struct WayangArsipPutramas.WayangInfo","name":"","type":"tuple"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint256","name":"tokenId","type":"uint256"}],"name":"getReviews","outputs":[{"components":[{"internalType":"address","name":"reviewer","type":"address"},{"internalType":"uint8","name":"bintang","type":"uint8"},{"internalType":"string","name":"ulasan","type":"string"},{"internalType":"uint256","name":"timestamp","type":"uint256"}],"internalType":"struct WayangArsipPutramas.Review[]","name":"","type":"tuple[]"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"user","type":"address"},{"internalType":"uint256","name":"index","type":"uint256"}],"name":"getTipByIndex","outputs":[{"components":[{"internalType":"address","name":"sender","type":"address"},{"internalType":"address","name":"receiver","type":"address"},{"internalType":"uint256","name":"amount","type":"uint256"},{"internalType":"string","name":"message","type":"string"},{"internalType":"uint256","name":"timestamp","type":"uint256"}],"internalType":"struct WayangArsipPutramas.TipRecord","name":"","type":"tuple"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"user","type":"address"}],"name":"getTipCount","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"_user","type":"address"}],"name":"getTipTotalBalance","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint256","name":"","type":"uint256"},{"internalType":"address","name":"","type":"address"}],"name":"hasLiked","outputs":[{"internalType":"bool","name":"","type":"bool"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint256","name":"","type":"uint256"},{"internalType":"address","name":"","type":"address"}],"name":"hasReviewed","outputs":[{"internalType":"bool","name":"","type":"bool"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"owner","type":"address"},{"internalType":"address","name":"operator","type":"address"}],"name":"isApprovedForAll","outputs":[{"internalType":"bool","name":"","type":"bool"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint256","name":"tokenId","type":"uint256"}],"name":"kasihLike","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"uint256","name":"tokenId","type":"uint256"},{"internalType":"uint8","name":"_bintang","type":"uint8"},{"internalType":"string","name":"_ulasanPilihan","type":"string"}],"name":"kasihUlasan","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[],"name":"name","outputs":[{"internalType":"string","name":"","type":"string"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint256","name":"tokenId","type":"uint256"}],"name":"ownerOf","outputs":[{"internalType":"address","name":"","type":"address"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"publicMintFee","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint256","name":"_tokenId","type":"uint256"},{"internalType":"string","name":"_namaBaru","type":"string"},{"internalType":"string","name":"_uriBaru","type":"string"}],"name":"revisiDataWayang","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"uint256","name":"_id","type":"uint256"},{"internalType":"string","name":"_namaBaru","type":"string"},{"internalType":"string","name":"_uriBaru","type":"string"}],"name":"revisiWayang","outputs":[],"stateMutability":"payable","type":"function"},{"inputs":[],"name":"revisionFee","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"from","type":"address"},{"internalType":"address","name":"to","type":"address"},{"internalType":"uint256","name":"tokenId","type":"uint256"}],"name":"safeTransferFrom","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address payable","name":"_receiver","type":"address"},{"internalType":"string","name":"_message","type":"string"}],"name":"sendTip","outputs":[],"stateMutability":"payable","type":"function"},{"inputs":[{"internalType":"address","name":"operator","type":"address"},{"internalType":"bool","name":"approved","type":"bool"}],"name":"setApprovalForAll","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"uint256","name":"_newFee","type":"uint256"}],"name":"setMintFee","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"uint256","name":"_newFee","type":"uint256"}],"name":"setRevisionFee","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"bytes4","name":"interfaceId","type":"bytes4"}],"name":"supportsInterface","outputs":[{"internalType":"bool","name":"","type":"bool"}],"stateMutability":"pure","type":"function"},{"inputs":[],"name":"symbol","outputs":[{"internalType":"string","name":"","type":"string"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint256","name":"tokenId","type":"uint256"}],"name":"tokenURI","outputs":[{"internalType":"string","name":"","type":"string"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint256","name":"","type":"uint256"}],"name":"totalLikes","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"","type":"address"}],"name":"totalReceived","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"totalTipsGrand","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"from","type":"address"},{"internalType":"address","name":"to","type":"address"},{"internalType":"uint256","name":"tokenId","type":"uint256"}],"name":"transferFrom","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"string","name":"_tokenURI","type":"string"},{"internalType":"string","name":"_nama","type":"string"},{"internalType":"string","name":"_golongan","type":"string"},{"internalType":"string","name":"_gaya","type":"string"}],"name":"uploadPublik","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"payable","type":"function"},{"inputs":[{"internalType":"address","name":"_owner","type":"address"}],"name":"walletOfOwner","outputs":[{"internalType":"uint256[]","name":"","type":"uint256[]"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint256","name":"","type":"uint256"}],"name":"wayangRegistry","outputs":[{"internalType":"string","name":"nama","type":"string"},{"internalType":"string","name":"golongan","type":"string"},{"internalType":"string","name":"gaya","type":"string"},{"internalType":"uint256","name":"timestamp","type":"uint256"},{"internalType":"bool","name":"isActive","type":"bool"},{"internalType":"bool","name":"isOfficial","type":"bool"},{"internalType":"address","name":"creator","type":"address"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint256","name":"","type":"uint256"},{"internalType":"uint256","name":"","type":"uint256"}],"name":"wayangReviews","outputs":[{"internalType":"address","name":"reviewer","type":"address"},{"internalType":"uint8","name":"bintang","type":"uint8"},{"internalType":"string","name":"ulasan","type":"string"},{"internalType":"uint256","name":"timestamp","type":"uint256"}],"stateMutability":"view","type":"function"}];

    const listGolongan = ["Satria", "Dewa", "Yaksa", "Wanara", "Panakawan", "Kayon", "Bambangan", "Punggawa", "Krodan", "Resi", "Putren", "Buta Kiwe", "Sato", "Gaman"];
    
    // Variabel Global
    let provider, contract;
    let foundIds = []; 
    const CACHE_KEY = 'putramas_data_cache';
    const CACHE_EXPIRY = 5 * 60 * 1000; // 5 menit

    // --- INIT (Jalan Otomatis) ---
    window.onload = async () => {
        try {
            console.log("Starting dashboard init...");
            // 1. Setup Provider dengan Try-Catch per Provider
            let alchemyProvider;
            try {
                alchemyProvider = new ethers.providers.JsonRpcProvider(ALCHEMY_RPC);
                await alchemyProvider.getNetwork(); // Test koneksi
                console.log("Alchemy connected successfully");
            } catch (alchemyError) {
                console.error("Alchemy connection failed:", alchemyError);
                alchemyProvider = null;
            }

            const publicProvider = new ethers.providers.JsonRpcProvider(PUBLIC_RPC);
            provider = alchemyProvider || publicProvider; // Prioritas Alchemy
            contract = new ethers.Contract(CONTRACT_ADDRESS, ABI, provider);
            
            console.log("Connected to Base via", alchemyProvider ? "Alchemy" : "Public RPC");

            // 2. Cek Cache
            const cachedData = getCache();
            if (cachedData) {
                console.log("Loading from cache...");
                renderFromCache(cachedData);
                // Update background jika expired
                setTimeout(async () => {
                    await fetchAndUpdate();
                }, 1000);
                return;
            }

            // 3. Fetch data jika no cache
            console.log("Fetching fresh data...");
            await fetchAndUpdate();

        } catch (e) {
            console.error("Init Error:", e);
            alert("Gagal memuat data dari Blockchain. Coba cek console browser (F12) untuk detail error, atau refresh.");
        } finally {
            document.querySelectorAll('.skeleton').forEach(el => el.classList.remove('skeleton'));
        }
    };

    // Fungsi Cache
    function getCache() {
        const cached = localStorage.getItem(CACHE_KEY);
        if (!cached) return null;
        const { data, timestamp } = JSON.parse(cached);
        if (Date.now() - timestamp > CACHE_EXPIRY) return null;
        return data;
    }

    function setCache(data) {
        localStorage.setItem(CACHE_KEY, JSON.stringify({ data, timestamp: Date.now() }));
    }

    function renderFromCache(cached) {
        console.log("Rendering from cache data...");
        // Render UI dari cache
        document.getElementById("val-supply").innerText = cached.total;
        document.getElementById("val-fee").innerText = cached.fee + " ETH";
        document.getElementById("val-tips").innerText = cached.tips + " ETH";
        document.getElementById("val-ratio").innerText = cached.ratio + "%";

        renderDoughnut("chartGolongan", listGolongan, cached.golData);
        renderPolar("chartGaya", cached.gayaLabels, cached.gayaVals);
    }

        async function fetchAndUpdate() {
        updateProgress(0);

        // 1. Ambil Data Utama (Wajib ditunggu/await karena mau masuk cache)
        const stats = await loadGlobalStats();  
        updateProgress(50);

        // 2. Ambil Data Detail (Wajib ditunggu/await karena mau masuk cache)
        const deep = await loadDeepDetails(); 
        
        // 3. Ambil Activity Feed (JANGAN pakai await)
        // Biarkan dia jalan sendiri di background agar tidak menunda render grafik utama
        loadActivity(); 

        updateProgress(100);

        // 4. Siapkan Data untuk Disimpan
        const cacheData = {
            total: stats.total,
            fee: stats.fee,
            tips: stats.tips,
            golData: stats.golData,
            ratio: deep.ratio,
            gayaLabels: deep.gayaLabels,
            gayaVals: deep.gayaVals
        };

        console.log("Saving new data to cache...");
        setCache(cacheData);
        
        // 5. Render Ulang Grafik Utama
        renderFromCache(cacheData); 
    }

    function updateProgress(percent) {
        document.getElementById('progress-bar').style.width = `${percent}%`;
    }

    // --- LOADERS TANPA MULTICALL ---
    
    async function loadGlobalStats() {
        console.log("Loading global stats...");
        let total = 0;
        let golData = [];
        
        // Fetch Basic
        const fee = ethers.utils.formatEther(await contract.publicMintFee().catch(() => 0));
        const tips = ethers.utils.formatEther(await contract.totalTipsGrand().catch(() => 0));

        // Fetch Golongan Loop
        const promises = listGolongan.map(async (g) => {
            const ids = await contract.getIdsByGolongan(g).catch(() => []);
            return { label: g, count: ids.length, ids: ids };
        });

        const results = await Promise.all(promises);
        
        results.forEach(res => {
            total += res.count;
            golData.push(res.count);
            if(res.ids.length > 0) foundIds.push(...res.ids);
        });

        console.log("Global stats loaded: total =", total);
        return { total, fee, tips, golData };
    }

        async function loadDeepDetails() {
        console.log("Loading deep details + Engagement...");
        let gayaCounts = {}; 
        let officialCount = 0;
        
        // Variabel baru untuk engagement
        let totalLikesGlobal = 0;
        let highestLikes = -1;
        let topWayangName = "-";

        const fetchPromises = foundIds.map(async (id) => {
            try {
                // Kita panggil wayangRegistry DAN totalLikes secara paralel per ID
                const [data, likesBn] = await Promise.all([
                    contract.wayangRegistry(id),
                    contract.totalLikes(id).catch(() => ethers.BigNumber.from(0))
                ]);
                
                return {
                    nama: data[0],
                    gaya: data[2], 
                    isOff: data[5],
                    likes: likesBn.toNumber()
                };
            } catch { return null; }
        });

        const details = await Promise.all(fetchPromises);

        details.forEach(d => {
            if(!d) return;
            gayaCounts[d.gaya] = (gayaCounts[d.gaya] || 0) + 1;
            if(d.isOff) officialCount++;
            
            // Hitung Likes
            totalLikesGlobal += d.likes;
            if (d.likes > highestLikes) {
                highestLikes = d.likes;
                topWayangName = d.nama;
            }
        });

        // Update UI Engagement (Langsung update elemen HTML baru)
        if(document.getElementById("val-total-likes")) {
            document.getElementById("val-total-likes").innerText = totalLikesGlobal;
            document.getElementById("val-top-wayang").innerText = topWayangName;
            document.getElementById("val-top-wayang-score").innerText = highestLikes + " Likes";
        }

        const ratio = foundIds.length > 0 ? ((officialCount / foundIds.length) * 100).toFixed(1) : "0";
        const gayaLabels = Object.keys(gayaCounts);
        const gayaVals = Object.values(gayaCounts);

        return { ratio, gayaLabels, gayaVals };
    }

       
    // --- CHARTS CONFIG --- (sama)
    Chart.defaults.font.family = "'Plus Jakarta Sans', sans-serif";
    Chart.defaults.color = '#64748b';

    function renderDoughnut(id, lbl, dat) {
        new Chart(document.getElementById(id), {
            type: 'doughnut',
            data: { labels: lbl, datasets: [{ data: dat, backgroundColor: ['#7385a5', '#889bbd', '#9db1d5', '#b2c7ed', '#c7ddff', '#5c6a84', '#a6b4cd'], borderWidth:0 }] },
            options: { maintainAspectRatio: false, plugins: { legend: { display: false } } }
        });
    }

    function renderPolar(id, lbl, dat) {
        new Chart(document.getElementById(id), {
            type: 'polarArea',
            data: { labels: lbl, datasets: [{ data: dat, backgroundColor: ['rgba(115,133,165,0.8)', 'rgba(197,160,89,0.8)', 'rgba(30,41,59,0.7)', 'rgba(226,232,240,0.9)'], borderWidth:2, borderColor:'#fff' }] },
            options: { maintainAspectRatio: false, scales: { r: { ticks: { display: false }, grid: { display: false } } }, plugins: { legend: { position:'right', labels: { boxWidth:10, usePointStyle:true } } } }
        });
    }

            // --- SNIPPET JS: Load Activity & Likes ---
            // --- 1. METODE KULKAS (Ambil Data Minting Langsung dari Storage) ---
    // Tidak pakai event log, tidak kena limit block, super cepat.
    async function loadRecentMintsFromStorage() {
        console.log("Membuka Kulkas: Mengambil data minting terbaru...");
        const feedContainer = document.getElementById('activity-feed');
        
        // Pastikan kita punya daftar ID (dari fungsi loadGlobalStats sebelumnya)
        if (!foundIds || foundIds.length === 0) {
            feedContainer.innerHTML = '<div style="text-align:center; padding:20px; color:#aaa;">Belum ada data wayang.</div>';
            return;
        }

        // 1. Urutkan ID dari terbesar (Terbaru) ke terkecil
        // Kita asumsikan ID besar = baru minting
        const sortedIds = foundIds.sort((a, b) => b - a).slice(0, 5); // Ambil 5 ID terbaru

        let html = '<ul style="list-style: none; padding: 0; margin: 0;">';

        // 2. Loop dan ambil detail langsung dari "wayangRegistry" (Mapping)
        for (let id of sortedIds) {
            try {
                const data = await contract.wayangRegistry(id);
                // data[0]=nama, data[1]=golongan, data[2]=gaya, data[6]=creator
                
                const nama = data[0];
                const gol = data[1];
                
                // Render HTML Item
                html += `
                <li style="padding: 12px 0; border-bottom: 1px solid #f0f0f0; display: flex; gap: 10px; align-items: flex-start;">
                    <div style="background: #e3f2fd; color: #1565c0; width: 32px; height: 32px; border-radius: 50%; display: flex; align-items: center; justify-content: center; flex-shrink: 0;">
                        <i class="fas fa-magic" style="font-size: 0.8rem;"></i>
                    </div>
                    <div>
                        <div style="font-size: 0.9rem; font-weight: 600;">Wayang Baru Lahir!</div>
                        <div style="font-size: 0.8rem; color: #666;">
                            <strong>${nama}</strong> (${gol})<br>
                            <span style="font-size:0.75rem; color:#999;">ID #${id}  Verified from Storage</span>
                        </div>
                    </div>
                </li>`;
            } catch (err) { console.warn("Gagal ambil ID", id); }
        }

        html += '</ul>';
        
        // Masukkan ke Container (Tapi jangan timpa loading spinner jika mau nunggu Tips)
        // Kita buat div khusus minting
        if(!document.getElementById('mint-feed')) {
            feedContainer.innerHTML = '<div id="live-feed"></div><div id="mint-feed"></div>';
        }
        document.getElementById('mint-feed').innerHTML = html;
    }

    // --- 2. METODE SATPAM (WebSocket / Event Listener) ---
    // Hanya mendengar data yang LEWAT SAJA. Tidak menggali kuburan (history).
    // Sangat ringan.
    function setupLiveListeners() {
        console.log("Mengaktifkan Satpam (Live Listener)...");
        const liveFeedDiv = document.getElementById('live-feed'); // Div bagian atas

        // A. Dengar ada Donasi Baru (TipSent)
        contract.on("TipSent", (from, to, amount, message, timestamp, event) => {
            console.log("Tip Terdeteksi!");
            const ethAmount = ethers.utils.formatEther(amount);
            const sender = from.substring(0, 6);

            const newHtml = `
            <li style="padding: 12px 0; border-bottom: 1px solid #f0f0f0; display: flex; gap: 10px; align-items: flex-start; background-color: #f0fff4; animation: highlight 2s;">
                <div style="background: #e8f5e9; color: #2e7d32; width: 32px; height: 32px; border-radius: 50%; display: flex; align-items: center; justify-content: center; flex-shrink: 0;">
                    <i class="fas fa-coins" style="font-size: 0.8rem;"></i>
                </div>
                <div>
                    <div style="font-size: 0.9rem; font-weight: 600;">Donasi Masuk <span style="color: #27ae60;">+${parseFloat(ethAmount).toFixed(4)} ETH</span></div>
                    <div style="font-size: 0.8rem; color: #666;">Dari: ${sender}...  "${message}"</div>
                    <div style="font-size: 0.7rem; color: #27ae60; font-weight:bold;"> LIVE BARU SAJA</div>
                </div>
            </li>`;
            
            // Sisipkan di paling atas
            if(liveFeedDiv) liveFeedDiv.insertAdjacentHTML('afterbegin', newHtml);
        });
    }

    // --- UPDATE FUNGSI FETCH UTAMA ---
    async function fetchAndUpdate() {
        updateProgress(0);
        
        // 1. Ambil Data Global & ID (Wajib)
        const stats = await loadGlobalStats();  
        updateProgress(40);

        // 2. Tampilkan Wayang dari "Kulkas" (Storage) - Menggunakan ID yang barusan diambil
        // INI PENGGANTI loadActivity() YANG LAMA
        await loadRecentMintsFromStorage(); 
        
        // 3. Aktifkan Listener untuk Donasi (Mode Satpam)
        setupLiveListeners();

        // 4. Ambil Detail (Deep)
        const deep = await loadDeepDetails(); 
        updateProgress(100);

        // Cache Logic (Sama seperti sebelumnya)
        const cacheData = {
            total: stats.total,
            fee: stats.fee,
            tips: stats.tips,
            golData: stats.golData,
            ratio: deep.ratio,
            gayaLabels: deep.gayaLabels,
            gayaVals: deep.gayaVals
        };
        setCache(cacheData);
        renderFromCache(cacheData); 
    }

            
        </script>

    <script>
        AOS.init({ once: true, offset: 100, duration: 800 });

        // Navbar Effect
        window.addEventListener('scroll', function() {
            const nav = document.getElementById('navbar');
            if (window.scrollY > 50) {
                nav.classList.add('scrolled');
            } else {
                nav.classList.remove('scrolled');
            }
        });

        document.getElementById("year").textContent = new Date().getFullYear();
    </script>
</body>
</html>
